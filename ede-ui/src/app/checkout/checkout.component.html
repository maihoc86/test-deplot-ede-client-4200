<div class="main-container container">
  <ul class="breadcrumb">
    <li><a href="#"><i class="fa fa-home"></i></a></li>
    <li><a href="#">Checkout</a></li>
  </ul>
  <div class="row">
    <!--Middle Part Start-->
    <div id="content" class="col-sm-12">
      <h2 class="title">Checkout</h2>
      <div class="so-onepagecheckout row">
        <div class="col-left col-sm-3">
          <div class="panel panel-default">
            <div class="panel-heading">
              <h4 class="panel-title">
                <i class="fa fa-sign-in"></i> Create an Account or Login
              </h4>
            </div>
            <div class="panel-body">
              <div class="radio">
                <label>
                  <input type="radio" value="register" name="account">Register Account</label>
              </div>
              <div class="radio">
                <label>
                  <input type="radio" checked="checked" value="guest" name="account">Guest Checkout</label>
              </div>
              <div class="radio">
                <label>
                  <input type="radio" value="returning" name="account">Returning Customer</label>
              </div>
            </div>
          </div>
          <div class="panel panel-default">
            <div class="panel-heading">
              <h4 class="panel-title">
                <i class="fa fa-user"></i> Your Personal Details
              </h4>
            </div>
            <div class="panel-body">
              <fieldset id="account">
                <div class="form-group required">
                  <label for="input-payment-firstname" class="control-label">First Name</label>
                  <input type="text" class="form-control" id="input-payment-firstname" placeholder="First Name" value=""
                    name="firstname">
                </div>
                <div class="form-group required">
                  <label for="input-payment-lastname" class="control-label">Last Name</label>
                  <input type="text" class="form-control" id="input-payment-lastname" placeholder="Last Name" value=""
                    name="lastname">
                </div>
                <div class="form-group required">
                  <label for="input-payment-email" class="control-label">E-Mail</label>
                  <input type="text" class="form-control" id="input-payment-email" placeholder="E-Mail" value=""
                    name="email">
                </div>
                <div class="form-group required">
                  <label for="input-payment-telephone" class="control-label">Telephone</label>
                  <input type="text" class="form-control" id="input-payment-telephone" placeholder="Telephone" value=""
                    name="telephone">
                </div>
                <div class="form-group">
                  <label for="input-payment-fax" class="control-label">Fax</label>
                  <input type="text" class="form-control" id="input-payment-fax" placeholder="Fax" value="" name="fax">
                </div>
              </fieldset>
            </div>
          </div>
          <div class="panel panel-default">
            <div class="panel-heading">
              <h4 class="panel-title"><i class="fa fa-book"></i> Your Address</h4>
            </div>
            <div class="panel-body">
              <fieldset id="address" class="required">
                <div class="form-group">
                  <label for="input-payment-company" class="control-label">Company</label>
                  <input type="text" class="form-control" id="input-payment-company" placeholder="Company" value=""
                    name="company">
                </div>
                <div class="form-group required">
                  <label for="input-payment-address-1" class="control-label">Address 1</label>
                  <input type="text" class="form-control" id="input-payment-address-1" placeholder="Address 1" value=""
                    name="address_1">
                </div>
                <div class="form-group">
                  <label for="input-payment-address-2" class="control-label">Address 2</label>
                  <input type="text" class="form-control" id="input-payment-address-2" placeholder="Address 2" value=""
                    name="address_2">
                </div>
                <div class="form-group required">
                  <label for="input-payment-city" class="control-label">City</label>
                  <input type="text" class="form-control" id="input-payment-city" placeholder="City" value=""
                    name="city">
                </div>
                <div class="form-group required">
                  <label for="input-payment-postcode" class="control-label">Post Code</label>
                  <input type="text" class="form-control" id="input-payment-postcode" placeholder="Post Code" value=""
                    name="postcode">
                </div>
                <div class="form-group required">
                  <label for="input-payment-country" class="control-label">Country</label>
                  <select class="form-control" id="input-payment-country" name="country_id">
                    <option value=""> --- Please Select --- </option>
                    <option value="244">Aaland Islands</option>
                    <option value="1">Afghanistan</option>
                    <option value="2">Albania</option>
                    <option value="3">Algeria</option>
                    <option value="4">American Samoa</option>
                    <option value="5">Andorra</option>
                    <option value="6">Angola</option>
                    <option value="7">Anguilla</option>
                    <option value="8">Antarctica</option>
                    <option value="9">Antigua and Barbuda</option>
                    <option value="10">Argentina</option>
                    <option value="11">Armenia</option>
                    <option value="12">Aruba</option>
                    <option value="252">Ascension Island (British)</option>
                    <option value="13">Australia</option>
                    <option value="14">Austria</option>
                    <option value="15">Azerbaijan</option>
                    <option value="16">Bahamas</option>
                    <option value="17">Bahrain</option>

                  </select>
                </div>
                <div class="form-group required">
                  <label for="input-payment-zone" class="control-label">Region / State</label>
                  <select class="form-control" id="input-payment-zone" name="zone_id">
                    <option value=""> --- Please Select --- </option>
                    <option value="3513">Aberdeen</option>
                    <option value="3514">Aberdeenshire</option>
                    <option value="3515">Anglesey</option>
                    <option value="3516">Angus</option>
                    <option value="3517">Argyll and Bute</option>
                    <option value="3518">Bedfordshire</option>
                    <option value="3519">Berkshire</option>
                    <option value="3520">Blaenau Gwent</option>
                    <option value="3521">Bridgend</option>
                    <option value="3522">Bristol</option>

                  </select>
                </div>
                <div class="checkbox">
                  <label>
                    <input type="checkbox" checked="checked" value="1" name="shipping_address">
                    My delivery and billing addresses are the same.</label>
                </div>
              </fieldset>
            </div>
          </div>
        </div>
        <div class="col-right col-sm-9">
          <div class="row">
            <div class="col-sm-12">

              <div class="panel panel-default no-padding">
                <div class="col-sm-8 checkout-shipping-methods">
                  <div class="panel-heading">
                    <h4 class="panel-title"><i class="fa fa-truck"></i> Phương thức vận chuyển</h4>
                  </div>
                  <div *ngIf="loadingAddress">
                    <div class="loader4"></div>
                  </div>
                  <form [formGroup]="ship" *ngIf="!loadingAddress">
                    <div class="panel-body">
                      <p>‎Nhập địa chỉ nhận hàng để có được ước tính phí vận chuyển.‎</p>
                      <div class="form-horizontal">
                        <div class="form-group required">
                          <label class="col-sm-2 control-label" for="input-country">Chọn đơn vị
                            vận chuyển</label>
                          <div class="col-sm-10">
                            <select name="country_id" id="input-country" class="form-control" formControlName="company"
                              (change)="chooseShippingCompany()">
                              <option [ngValue]="null" disabled> --- Chọn đơn vị vận chuyển
                                --- </option>
                              <option *ngFor="let prf of listShippingCompany" [ngValue]="prf.id">
                                {{ prf.name }}
                              </option>
                            </select>
                          </div>
                        </div>
                        <div class="form-group required">
                          <label class="col-sm-2 control-label" for="input-country">Tỉnh /
                            thành</label>
                          <div class="col-sm-10">
                            <select name="country_id" id="input-country" class="form-control" formControlName="city"
                              (change)="chooseCity()">
                              <option [ngValue]="null" disabled> --- Chọn tỉnh thành ---
                              </option>
                              <option *ngFor="let prf of listCitys" [ngValue]="prf.id"
                                [attr.selected]="prf.id == ship.controls['company'].value ? true : null">
                                {{ prf.name }}
                              </option>
                            </select>
                          </div>
                        </div>
                        <div class="form-group required">
                          <label class="col-sm-2 control-label">Quận huyện</label>
                          <div class="col-sm-10">
                            <select name="country_id" id="input-country" class="form-control" formControlName="district"
                              (change)="chooseDistrict()">
                              <option [ngValue]="null" disabled> --- Chọn quận huyện ---
                              </option>
                              <option *ngFor="let prf of listDistricts" [ngValue]="prf.id">
                                {{ prf.name }}
                              </option>
                            </select>
                          </div>
                        </div>
                        <div class="form-group required">
                          <label class="col-sm-2 control-label" for="input-zone">Phường /
                            xã</label>
                          <div class="col-sm-10">
                            <select name="zone_id" id="input-zone" class="form-control" formControlName="wards"
                              (change)="chooseWards()">
                              <option [ngValue]="null" disabled> --- Chọn phường xã ---
                              </option>
                              <option *ngFor="let prf of listWards" [ngValue]="prf.id">
                                {{ prf.name }}
                              </option>
                            </select>
                          </div>
                        </div>
                        <div class="form-group required">
                          <label class="col-sm-2 control-label" for="input-address">Địa chỉ</label>
                          <div class="col-sm-10"><input type="text" name="address" formControlName="address"
                              placeholder="Địa chỉ" id="input-address" class="form-control">
                            <span *ngIf="ship.controls['address'].value != ''"><a
                                style="color: #ff3c20; cursor: pointer;" data-toggle="modal" data-target="#exampleModal"
                                (click)="getAllAddressUser()"> + Chọn địa
                                chỉ hiện có</a></span>
                          </div>
                        </div>
                        <div class="modal fade bd-example-modal-lg" id="exampleModal" tabindex="-1" role="dialog"
                          aria-labelledby="exampleModalLabel" aria-hidden="true">
                          <div class="modal-dialog modal-lg" role="document">
                            <div class="modal-content">
                              <div class="modal-header">
                                <h3 class="modal-title" id="exampleModalLabel">Địa chỉ nhận hàng</h3>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                  <span aria-hidden="true">&times;</span>
                                </button>
                                <div class="row">
                                  <div class="col-sm-12" style="margin-top: 16px;">
                                    <input type="submit" class="btn btn-danger" value="Thêm địa chỉ mới"
                                      (click)="addNewAddressUser()" style="border-radius:4px 4px; width: 130px;">
                                    &nbsp;
                                  </div>
                                </div><br>
                              </div>
                              <div class="modal-body">
                                <div class="table-responsive">
                                  <table class="table table-bordered table-hover">
                                    <thead>
                                      <tr>
                                        <td>Địa chỉ</td>
                                      </tr>
                                    </thead>
                                    <tbody>
                                      <tr (click)="changeAddressUser(user.address)" data-dismiss="modal">
                                        <td style="cursor: pointer; height: 60px">{{user.address}} <span
                                            style="color: #ff3c20;"> > MẶC ĐỊNH</span> </td>
                                      </tr>
                                      <tr *ngFor="let a of listAddressUser" data-dismiss="modal">
                                        <td (click)="changeAddressUser(a.address)" style="cursor: pointer;height: 60px">
                                          {{a.address}}</td>
                                      </tr>
                                    </tbody>
                                  </table>
                                </div>
                              </div>
                              <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Đóng</button>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </form>
                </div>
                <div class="col-sm-4  checkout-payment-methods">
                  <div class="panel-heading">
                    <h4 class="panel-title"><i class="fa fa-credit-card"></i> Phương thức thanh toán</h4>
                  </div>
                  <div class="panel-body">
                    <p>Vui lòng chọn phương thức thanh toán ưa thích để sử dụng cho đơn hàng này.</p>
                    <div class="form-check">
                      <input type="radio" class="form-check-input" checked="checked" name="Thanh toán khi nhận hàng"
                        name="rdoThanhToan" id="rdoCash" style="cursor: pointer;"
                        (click)="showDetailMethodPayment('Cash')">
                      <label class="form-check-label" for="rdoCash" style="cursor: pointer;">
                        <img src=" /assets/image/icon/dollar-folder-icon.png" alt="cash">&nbsp;
                        Thanh toán khi nhận hàng</label>
                    </div>
                    <div class="form-check">
                      <input type="radio" class="form-check-input" name="Thanh toán qua Internet Banking"
                        name="rdoThanhToan" id="rdoBanking" style="cursor: pointer;"
                        (click)="showDetailMethodPayment('Internet Banking')">
                      <label class="form-check-label" for="rdoBanking" style="cursor: pointer;">
                        <img src=" /assets/image/icon/atm-banking.jpg" alt="banking">&nbsp;Thanh toán qua
                        Internet Banking</label>
                    </div>
                    <div *ngIf="showDetailPayment == 'Internet Banking'">
                      <div *ngFor="let item of listDetailPaymentSystem">
                        <div class="content-bank">
                          <span>Số tài khoản: </span> <span class="span-main">{{item.soTaiKhoan}}</span><br>
                          <span>Họ tên: </span> <span class="span-main">{{item.soTaiKhoan}}</span><br>
                          <span>Ngân hàng: </span> <span class="span-main">{{item.soTaiKhoan}}</span><br>
                          <span>Chi nhánh: </span> <span class="span-main">{{item.soTaiKhoan}}</span><br>
                          <span>Nội dung chuyển tiền: </span> <span class="span-main noidung">TEST123EDE</span><br>
                        </div>
                      </div>
                    </div>
                    <div class="form-check">
                      <input type="radio" class="form-check-input" name="Thanh toán qua MoMo" name="rdoThanhToan"
                        id="rdoMoMo" style="cursor: pointer;" (click)="showDetailMethodPayment('Momo')">
                      <label class="form-check-label" for="rdoMoMo" style="cursor: pointer;">
                        <img src=" /assets/image/icon/icon-momo.png" alt="MoMo">&nbsp; Thanh toán qua MoMo</label>
                    </div>
                    <div *ngIf="showDetailPayment == 'Momo'">
                      <div *ngFor="let item of listDetailPaymentSystem">
                        <div class="content-bank">
                          <span>Số điện thoại: </span> <span class="span-main">{{item.soDienThoai}}</span><br>
                          <span>Họ tên: </span> <span class="span-main">{{item.soDienThoai}}</span><br>
                          <span>Nội dung chuyển tiền: </span> <span class="span-main noidung">TEST123EDE</span><br>
                        </div>
                        <div style="text-align: center;">
                          <span>- Hoặc -</span>
                        </div>
                        <div>
                          <!-- Nữa lấy plugin gắn mã qr tự động theo nội dung -->
                          <img src="https://abpvn.com/donate/momo-qr.jpg" alt="">
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-sm-12">
              <div class="panel panel-default">
                <div class="panel-heading">
                  <h4 class="panel-title"><i class="fa fa-ticket"></i> Bạn có phiếu giảm giá hoặc voucher không?</h4>
                </div>
                <div class="panel-body row">
                  <div class="col-sm-6">
                    <span class="input-group-btn">
                      <input type="submit" class="btn btn-primary" data-loading-text="Loading..." id="button-voucher"
                        value="Xem danh sách mã giảm giá" data-toggle="modal" data-target="#modalGiamGia"
                        (click)="getAllOrderDiscount()">
                    </span>
                  </div>
                  <div class="col-sm-6"
                    *ngIf="discountOrder && discountOrder !== 'null' && discountOrder !== 'undefined'">
                    <i class="fa fa-ticket"></i> Mã giảm đã chọn:
                    <div class="input-group-btn">
                      <div class="row">
                        <div class="col-sm-8">
                          <input type="text" class="form-control"
                            value="Giảm giá {{discountOrder.discount}}% cho sản phẩm >= {{discountOrder.total}}"
                            readonly>
                        </div>
                        <div class="col-sm-4">
                          <button type="button" data-toggle="tooltip" title="Xóa" class="btn btn-danger"
                            (click)="removeDiscount()"><i class="fa fa-times-circle"></i></button>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!-- Modal Discount -->
                  <div class="modal fade bd-example-modal-lg" id="modalGiamGia" tabindex="-1" role="dialog"
                    aria-labelledby="modalGiamGiaLabel" aria-hidden="true">
                    <div class="modal-dialog modal-lg" role="document">
                      <div class="modal-content">
                        <div class="modal-header">
                          <h3 class="modal-title" id="modalGiamGiaLabel">Danh sách mã giảm giá</h3>
                          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                          </button>
                        </div>
                        <div class="modal-body">
                          <div class="table-responsive">
                            <table class="table table-bordered table-hover">
                              <thead>
                                <tr>
                                  <td><strong>Giảm</strong></td>
                                  <td><strong>Có giá trị hóa đơn từ</strong></td>
                                  <td><strong>Ngày hết hạn</strong></td>
                                  <td><strong>Hiệu lực</strong></td>
                                </tr>
                              </thead>
                              <tbody>
                                <tr *ngFor="let item of listDiscountOrder" (click)="chooseDiscountOrder(item)"
                                  data-dismiss="modal" style="cursor: pointer;">
                                  <td>{{item.discount}} %</td>
                                  <td> >= {{item.total | currency :'VND'}}</td>
                                  <td>{{item.enddate}}</td>
                                  <td>{{item.status == 1 ? 'Còn' : 'Hết'}}</td>
                                </tr>
                              </tbody>
                            </table>
                          </div>
                        </div>
                        <div class="modal-footer">
                          <button type="button" class="btn btn-secondary" data-dismiss="modal">Đóng</button>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!-- End Modal Discount -->
                </div>
              </div>
              <div class="col-sm-12">
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <h4 class="panel-title"><i class="fa fa-shopping-cart"></i> Shopping cart</h4>
                  </div>
                  <div class="panel-body">
                    <div class="table-responsive">
                      <table class="table table-bordered">
                        <thead>
                          <tr>
                            <td class="text-center">Ảnh đại diện</td>
                            <td class="text-left">Tên sản phẩm</td>
                            <td class="text-left">Số Lượng</td>
                            <td class="text-right">Đơn giá</td>
                            <td class="text-right">Phí vận chuyển</td>
                            <td class="text-right">Tổng giá</td>
                          </tr>
                        </thead>
                        <tbody>
                          <tr *ngFor="let item of productList; let index = index">
                            <td class="text-center">
                              <a href="">
                                <img width="60px"
                                  [src]="'http://localhost:8080/ede-file/get/image/' + item?.product_option?.optionImageDef?.image"
                                  alt="Ảnh mô tả" class="img-thumbnail">
                              </a>
                            </td>
                            <td class="text-left">
                              <a href="">{{item?.product_option?.display_name}}</a>
                            </td>
                            <td class="text-left">
                              <div class="input-group btn-block" style="min-width: 100px;">
                                <input type="number" value={{item.quantity}} #qty class="form-control"
                                  (keypress)="numberOnly($event)" (change)="changeQty(item, qty.value)">
                              </div>
                            </td>
                            <td class="text-right">{{item?.product_option?.price | currency :'VND'}}</td>
                            <td class="text-right">{{item.feeShip| currency :'VND'}}</td>
                            <td class="text-right">
                              {{(item.product_option.productDiscount[0]?(item.product_option.price*item.quantity)-(((item.product_option.price
                              + item.feeShip)
                              *item.quantity)*(item.product_option.productDiscount[0].discount/100)):(item.product_option.price
                              + item.feeShip)*item.quantity)|
                              currency :'VND'}}
                            </td>
                          </tr>
                        </tbody>
                        <tfoot>
                          <tr>
                            <td class="text-right" colspan="5"><strong>Tạm tính:</strong></td>
                            <td class="text-right">{{totalPriceBeforeDiscount | currency :'VND'}}</td>
                          </tr>
                          <tr *ngIf="discountPrice > 0">
                            <td class="text-right" colspan="5"><strong>Giảm:</strong></td>
                            <td class="text-right">{{discountPrice | currency :'VND'}}</td>
                          </tr>
                          <tr>
                            <td class="text-right" colspan="5"><strong>Tổng tiền:</strong></td>
                            <td class="text-right">{{totalprice | currency :'VND'}}</td>
                          </tr>
                        </tfoot>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-sm-12">
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <h4 class="panel-title"><i class="fa fa-pencil"></i> Thêm chú thích về Đơn hàng của bạn</h4>
                  </div>
                  <div class="panel-body">
                    <textarea rows="4" class="form-control" id="confirm_comment" name="comments"></textarea>
                    <br>
                    <label class="control-label" for="confirm_agree">
                      <input type="checkbox" checked="checked" value="1" required="" class="validate required"
                        id="confirm_agree" name="confirm agree">
                      <span>Tôi đã đọc và đồng ý với các <a class="agree" href="#"><b>Điều khoản &amp;
                            Điều kiện</b></a></span> </label>
                    <div class="buttons">
                      <div class="pull-right">
                        <input type="button" class="btn btn-primary" id="button-confirm" value="Confirm Order">
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!--Middle Part End -->
    </div>
  </div>
